<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Analisando dados no terminal - João Maia</title>
	<script>(function(d,e){d[e]=d[e].replace("no-js","js");})(document.documentElement,"className");</script>
	<meta name="description" content="">
		<meta property="og:title" content="Analisando dados no terminal" />
<meta property="og:description" content="Olá,
recentemente fazendo uma inspeção na aplicação precisei ver seu logs para entender com mais detalhes o que estava acontecendo em termos de comportamento e com isso para ser produtivo na atividade fiz uso de recursos presentes no meu terminal para realizar a atividade. Neste artigo vou compartilhar as ferramentas que usei e como elas podem ser úteis para você também. O interessante que depois de falar a respeito disso no Twitter surgiram comentários interessantes." />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://blog.joaovrmaia.com/post/analisando-dados-no-terminal/" /><meta property="article:section" content="post" />
<meta property="article:published_time" content="2020-05-01T00:00:00+00:00" />
<meta property="article:modified_time" content="2020-05-01T00:00:00+00:00" />


		<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Analisando dados no terminal"/>
<meta name="twitter:description" content="Olá,
recentemente fazendo uma inspeção na aplicação precisei ver seu logs para entender com mais detalhes o que estava acontecendo em termos de comportamento e com isso para ser produtivo na atividade fiz uso de recursos presentes no meu terminal para realizar a atividade. Neste artigo vou compartilhar as ferramentas que usei e como elas podem ser úteis para você também. O interessante que depois de falar a respeito disso no Twitter surgiram comentários interessantes."/>

	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link rel="dns-prefetch" href="//fonts.googleapis.com">
	<link rel="dns-prefetch" href="//fonts.gstatic.com">
	<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700">

	<link rel="stylesheet" href="/css/style.css">
	<link rel="stylesheet" href="/css/custom.css">

	<link rel="shortcut icon" href="/favicon.ico">
		
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
	ga('create', 'UA-61280444-1', 'auto');
	
	ga('send', 'pageview');
}
</script>
<script async src='https://www.google-analytics.com/analytics.js'></script>

</head>
<body class="body">
	<div class="container container--outer">
		<header class="header">
	<div class="container header__container">
		
	<div class="logo">
		<a class="logo__link" href="/" title="João Maia" rel="home">
			<div class="logo__item logo__text">
					<div class="logo__title">João Maia</div>
					<div class="logo__tagline">Compartilhando conhecimento sobre tecnologia e outras coisas mais</div>
				</div>
		</a>
	</div>
		
<nav class="menu">
	<button class="menu__btn" aria-haspopup="true" aria-expanded="false" tabindex="0">
		<span class="menu__btn-title" tabindex="-1">Menu</span>
	</button>
	<ul class="menu__list">
		<li class="menu__item">
			<a class="menu__link" href="/about/">
				
				<span class="menu__text">Sobre</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/post/">
				
				<span class="menu__text">Posts</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/tags/">
				
				<span class="menu__text">Tags</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="/categories/">
				
				<span class="menu__text">Categoria</span>
				
			</a>
		</li>
		<li class="menu__item">
			<a class="menu__link" href="http://www.joaovrmaia.com">
				
				<span class="menu__text">Site pessoal</span>
				
			</a>
		</li>
	</ul>
</nav>

	</div>
</header>
		<div class="wrapper flex">
			<div class="primary">
			
<main class="main" role="main">
	<article class="post">
		<header class="post__header">
			<h1 class="post__title">Analisando dados no terminal</h1>
			<div class="post__meta meta">
<div class="meta__item-datetime meta__item">
	<svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class="meta__text" datetime="2020-05-01T00:00:00Z">2020-05-01</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2l1 2h8v11h-16v-13z"/></svg><span class="meta__text"><a class="meta__link" href="/categories/produtividade/" rel="category">produtividade</a>, <a class="meta__link" href="/categories/devops/" rel="category">devops</a>
	</span>
</div></div>
		</header>
		<figure class="post__thumbnail">
			<img src="/img/analisando-dados-no-terminal/terminal-tips.png" alt="Analisando dados no terminal">
		</figure><div class="content post__content clearfix">
			<p>Olá,</p>
<p>recentemente fazendo uma inspeção na aplicação precisei ver seu logs para entender com mais detalhes o que estava acontecendo em termos de comportamento e com isso para ser produtivo na atividade fiz uso de recursos presentes no meu terminal para realizar a atividade. Neste artigo vou compartilhar as ferramentas que usei e como elas podem ser úteis para você também. O interessante que depois de falar a respeito disso no <a href="https://twitter.com/jvrmaia/status/1255963940804313088">Twitter</a> surgiram comentários interessantes. O primeiro foi esse <a href="https://adamdrake.com/command-line-tools-can-be-235x-faster-than-your-hadoop-cluster.html">artigo</a> e o segundo foi a ferramenta <a href="https://www.gnu.org/software/datamash/">datamash</a>.</p>
<blockquote>
<p>AVISO: não assuma que sei isso tudo de memória e não se pressione a saber, muita coisa aqui tiver que procurar no Google que não lembrava ;D</p>
</blockquote>
<h1 id="as-ferramentas">As ferramentas</h1>
<p>Os principais comandos que vou utilizar aqui são: <a href="http://man7.org/linux/man-pages/man1/cat.1.html">cat</a>, <a href="https://stedolan.github.io/jq/">jq</a>, <a href="https://www.gnu.org/software/gawk/manual/gawk.html">awk</a>, <a href="http://man7.org/linux/man-pages/man1/sort.1.html">sort</a>, <a href="http://man7.org/linux/man-pages/man1/tail.1.html">tail</a>, <a href="http://linuxcommand.org/lc3_man_pages/grep1.html">grep</a>, <a href="http://man7.org/linux/man-pages/man1/uniq.1.html">uniq</a> e <a href="https://www.gnu.org/software/bash/manual/html_node/Pipelines.html">pipelines</a>.</p>
<h2 id="cat">cat</h2>
<p>O <code>cat</code> é um comando bem simples que é usado no geral para mostrar no terminal as informações de uma arquivo ou mais passados via argumentos, por exemplo:</p>
<pre tabindex="0"><code>$ cat hello.txt
world
</code></pre><p>Existem alguns outros recursos interessantes que valem nota para o uso que são as opções <code>-n</code> e <code>-b</code>:</p>
<pre tabindex="0"><code>$ cat -n hello.txt
     1 world
$ cat linhas.txt
primeira linha

segunda linha
terceira linha
$ cat -b linhas.txt
     1	primeira linha

     2	segunda linha
     3	terceira linha
</code></pre><p>Ambos mostram o número da linha com a diferença que na segunda opção as linhas em branco não são consideradas.</p>
<h3 id="bônus">Bônus</h3>
<p>Descobrir o que acontece se fizermos isso:</p>
<pre tabindex="0"><code>$ cat &gt;a.txt&lt;&lt;EOF
&gt; abcEOF
&gt; 123
&gt; EOF
</code></pre><h2 id="tail">tail</h2>
<p>O <code>tail</code> parece com o <code>cat</code> mas o que ele faz é retornar os dados na ordem inversa do <code>cat</code> e com limitação na quantidade de linhas. Vamos testar com o <code>/etc/resolv.conf</code>:</p>
<pre tabindex="0"><code>$ cat -n /etc/resolv.conf
     1	# This file is managed by man:systemd-resolved(8). Do not edit.
     2	#
     3	# This is a dynamic resolv.conf file for connecting local clients to the
     4	# internal DNS stub resolver of systemd-resolved. This file lists all
     5	# configured search domains.
     6	#
     7	# Run &quot;systemd-resolve --status&quot; to see details about the uplink DNS servers
     8	# currently in use.
     9	#
    10	# Third party programs must not access this file directly, but only through the
    11	# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,
    12	# replace this symlink by a static file or a different symlink.
    13	#
    14	# See man:systemd-resolved.service(8) for details about the supported modes of
    15	# operation for /etc/resolv.conf.
    16
    17	nameserver 127.0.0.53
    18	options edns0
</code></pre><p>Usei o <code>cat</code> aqui para termos uma visibilidade do quem no arquivo como um todo. Agora, vamos ao <code>tail</code>.</p>
<pre tabindex="0"><code>$ tail /etc/resolv.conf
#
# Third party programs must not access this file directly, but only through the
# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,
# replace this symlink by a static file or a different symlink.
#
# See man:systemd-resolved.service(8) for details about the supported modes of
# operation for /etc/resolv.conf.

nameserver 127.0.0.53
options edns0
</code></pre><p>Já deu para notar que a quantidade de dados que veio foi reduzida, sabendo que são 18 linhas, para ver todas com o <code>tail</code>, podemos fazer:</p>
<pre tabindex="0"><code>$ tail -n 18 /etc/resolv.conf
# This file is managed by man:systemd-resolved(8). Do not edit.
#
# This is a dynamic resolv.conf file for connecting local clients to the
# internal DNS stub resolver of systemd-resolved. This file lists all
# configured search domains.
#
# Run &quot;systemd-resolve --status&quot; to see details about the uplink DNS servers
# currently in use.
#
# Third party programs must not access this file directly, but only through the
# symlink at /etc/resolv.conf. To manage man:resolv.conf(5) in a different way,
# replace this symlink by a static file or a different symlink.
#
# See man:systemd-resolved.service(8) for details about the supported modes of
# operation for /etc/resolv.conf.

nameserver 127.0.0.53
options edns0
</code></pre><p>Assim como podemos fazer para ver menos linhas:</p>
<pre tabindex="0"><code>$ tail -n 2 /etc/resolv.conf
nameserver 127.0.0.53
options edns0
</code></pre><h3 id="bônus-1">Bônus</h3>
<p>Procure algum arquivo de log com escrita constante no seu computador ou servidor e execute, por exemplo: <code>$ tail -f /var/log/syslog</code>.</p>
<h2 id="pipelines">pipelines</h2>
<p>Acho que esse usamos e acabamos nem percebendo, quem nunca viu algum projeto livre por ai que o primeiro comando não é um <code>curl</code> ou <code>wget</code> para fazer download de uma aquivo, um <code>|</code> e <code>bash</code>. Então, esse <code>|</code> é o <code>pipelines</code>. O que esse comando fazer é conectar uma cadeia de comandos:</p>
<pre tabindex="0"><code>comando1 | comando2 | comando3 | ... | comandoN
</code></pre><p>O que estamos fazendo ai é que o <code>comando1</code> vai gerar uma saída que vai ser entrada do <code>comando2</code> que por consequência vai gerar uma saída nova que será a entrada do <code>comando3</code> e assim até o <code>comandoN</code>. No próximo item, <code>jq</code>, vamos explorar melhor isso na prática.</p>
<h3 id="bônus-2">Bônus</h3>
<p>Existe uma variação do comando, <code>|&amp;</code>, que é para redirecionar as saídas de erro.</p>
<h2 id="jq">jq</h2>
<p>É uma ferramenta bem legal feita em Node para lidarmos com JSON/string no terminal. Aqui não vamos explorar muito ela pois acho que isso pode ser um artigo só para isso de tantas coisas interessantes que ele tem. Vamos supor o seguinte JSON de uma compra em e-commerce:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="p">{</span>
    <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">12345</span><span class="p">,</span>
    <span class="nt">&#34;cliente&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">3243</span><span class="p">,</span>
        <span class="nt">&#34;nome&#34;</span><span class="p">:</span> <span class="s2">&#34;joão da silva&#34;</span>
    <span class="p">},</span>
    <span class="nt">&#34;estado&#34;</span><span class="p">:</span> <span class="s2">&#34;aguardando pagamento&#34;</span><span class="p">,</span>
    <span class="nt">&#34;valor_total&#34;</span><span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
    <span class="nt">&#34;carrinho&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;valor&#34;</span><span class="p">:</span> <span class="mf">300.0</span><span class="p">,</span>
        <span class="nt">&#34;produtos&#34;</span><span class="p">:</span> <span class="p">[</span>
            <span class="p">{</span>
                <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
                <span class="nt">&#34;nome&#34;</span><span class="p">:</span> <span class="s2">&#34;livro do dragão&#34;</span><span class="p">,</span>
                <span class="nt">&#34;quantidade&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&#34;valor_unitario&#34;</span><span class="p">:</span> <span class="mf">150.0</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">312</span><span class="p">,</span>
                <span class="nt">&#34;nome&#34;</span><span class="p">:</span> <span class="s2">&#34;copos&#34;</span><span class="p">,</span>
                <span class="nt">&#34;quantidade&#34;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>
                <span class="nt">&#34;valor_unitario&#34;</span><span class="p">:</span> <span class="mf">10.0</span>
            <span class="p">},</span>
            <span class="p">{</span>
                <span class="nt">&#34;id&#34;</span><span class="p">:</span> <span class="mi">213</span><span class="p">,</span>
                <span class="nt">&#34;nome&#34;</span><span class="p">:</span> <span class="s2">&#34;camisa preta&#34;</span><span class="p">,</span>
                <span class="nt">&#34;quantidade&#34;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                <span class="nt">&#34;valor_unitario&#34;</span><span class="p">:</span> <span class="mf">50.0</span>
            <span class="p">}</span>
        <span class="p">]</span>
    <span class="p">},</span>
    <span class="nt">&#34;entrega&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;endereco&#34;</span><span class="p">:</span> <span class="p">{</span>
            <span class="nt">&#34;rua&#34;</span><span class="p">:</span> <span class="s2">&#34;rua x&#34;</span><span class="p">,</span>
            <span class="nt">&#34;numero&#34;</span><span class="p">:</span> <span class="mi">123</span><span class="p">,</span>
            <span class="nt">&#34;complemento&#34;</span><span class="p">:</span> <span class="s2">&#34;apt 101&#34;</span><span class="p">,</span>
            <span class="nt">&#34;cidade&#34;</span><span class="p">:</span> <span class="s2">&#34;vitoria&#34;</span><span class="p">,</span>
            <span class="nt">&#34;estado&#34;</span><span class="p">:</span> <span class="s2">&#34;es&#34;</span><span class="p">,</span>
            <span class="nt">&#34;cep&#34;</span><span class="p">:</span> <span class="s2">&#34;29000000&#34;</span>
        <span class="p">},</span>
        <span class="nt">&#34;valor&#34;</span><span class="p">:</span> <span class="mf">0.0</span>
    <span class="p">},</span>
    <span class="nt">&#34;pagamento&#34;</span><span class="p">:</span> <span class="p">{</span>
        <span class="nt">&#34;tipo&#34;</span><span class="p">:</span> <span class="s2">&#34;boleto&#34;</span><span class="p">,</span>
        <span class="nt">&#34;codigo_barra&#34;</span><span class="p">:</span> <span class="s2">&#34;23790504004200050320330008109206182470000019900&#34;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div><h3 id="nome-do-cliente">Nome do cliente</h3>
<pre tabindex="0"><code>$ cat compra.json | jq .cliente.nome
&quot;joão da silva&quot;
</code></pre><h3 id="listar-produtos">Listar produtos</h3>
<pre tabindex="0"><code>$ cat compra.json | jq .carrinho.produtos
[
  {
    &quot;id&quot;: 123,
    &quot;nome&quot;: &quot;livro do dragão&quot;,
    &quot;quantidade&quot;: 1,
    &quot;valor_unitario&quot;: 150
  },
  {
    &quot;id&quot;: 312,
    &quot;nome&quot;: &quot;copos&quot;,
    &quot;quantidade&quot;: 10,
    &quot;valor_unitario&quot;: 10
  },
  {
    &quot;id&quot;: 213,
    &quot;nome&quot;: &quot;camisa preta&quot;,
    &quot;quantidade&quot;: 1,
    &quot;valor_unitario&quot;: 50
  }
]
</code></pre><h3 id="nome-dos-produtos">Nome dos produtos</h3>
<pre tabindex="0"><code>$ cat compra.json | jq .carrinho.produtos[].nome
&quot;livro do dragão&quot;
&quot;copos&quot;
&quot;camisa preta&quot;
</code></pre><h3 id="valor-da-entrega">Valor da entrega</h3>
<pre tabindex="0"><code>$ cat compra.json | jq .entrega.valor
0
</code></pre><h3 id="quantidade-de-itens-bônus">Quantidade de itens (Bônus)</h3>
<pre tabindex="0"><code>$ cat compra.json | jq -n '[inputs | .carrinho.produtos[].quantidade] | reduce .[] as $num (0; .+$num)'
12
</code></pre><h2 id="grep">grep</h2>
<p>O <code>grep</code> é uma comando para procurar padrões em arquivos e imprimir suas ocorrências por linha. Vamos explorar o uso <code>grep</code> no arquivo: <code>/etc/sysctl.conf</code>.</p>
<h3 id="todas-configurações-presentes-relativas-a-ipv4">Todas configurações presentes relativas a IPv4</h3>
<pre tabindex="0"><code>$ grep ipv4 /etc/sysctl.conf
#net.ipv4.conf.default.rp_filter=1
#net.ipv4.conf.all.rp_filter=1
#net.ipv4.tcp_syncookies=1
#net.ipv4.ip_forward=1
#net.ipv4.conf.all.accept_redirects = 0
# net.ipv4.conf.all.secure_redirects = 1
#net.ipv4.conf.all.send_redirects = 0
#net.ipv4.conf.all.accept_source_route = 0
#net.ipv4.conf.all.log_martians = 1
</code></pre><h3 id="todas-as-configurações-ativas">Todas as configurações ativas</h3>
<p>Sabendo que <code>#</code> no começo da linha significa que a linha está comentada.</p>
<pre tabindex="0"><code>$ grep -v ^# /etc/sysctl.conf












fs.inotify.max_user_watches=524288 # nao comentada
</code></pre><p>Várias linhas em branco e nota-se que a última não foi pega no <code>grep</code> pois o <code>^</code> indica começo da linha, como o <code>#</code> está no meio da linha o casamento de padrão é falso.</p>
<h3 id="bônus-3">Bônus</h3>
<pre tabindex="0"><code>$ grep -i --color -e 'ipv[46]' /etc/sysctl.conf
#net.ipv4.conf.default.rp_filter=1
#net.ipv4.conf.all.rp_filter=1
# Note: This may impact IPv6 TCP sessions too
#net.ipv4.tcp_syncookies=1
# Uncomment the next line to enable packet forwarding for IPv4
#net.ipv4.ip_forward=1
# Uncomment the next line to enable packet forwarding for IPv6
#net.ipv6.conf.all.forwarding=1
#net.ipv4.conf.all.accept_redirects = 0
#net.ipv6.conf.all.accept_redirects = 0
# net.ipv4.conf.all.secure_redirects = 1
#net.ipv4.conf.all.send_redirects = 0
#net.ipv4.conf.all.accept_source_route = 0
#net.ipv6.conf.all.accept_source_route = 0
#net.ipv4.conf.all.log_martians = 1
</code></pre><p>Recomendo executar para ver a opção <code>--color</code> funcionando e entender melhor a <code>-i</code>.</p>
<h2 id="sort">sort</h2>
<p>Como próprio nome sugere, o <code>sort</code> vai ordenar uma entrada informada por linhas. Vamos tomar o seguinte arquivo para exemplo:</p>
<pre tabindex="0"><code>$ cat ordenar.txt
zambia
nigeria
áfrica do sul
moçambique
mandagascar
93213
123123
13
3215
123
!@#!@#
5$%$%

~`''`
</code></pre><p>Você acha que conseguiria ordenar apenas no olhar de forma igual?</p>
<pre tabindex="0"><code>$ sort ordenar.txt

~`''`
!@#!@#
123
123123
13
3215
5$%$%
93213
áfrica do sul
mandagascar
moçambique
nigeria
zambia
</code></pre><h3 id="bônus-4">Bônus</h3>
<p>Considerando o seguinte arquivo:</p>
<pre tabindex="0"><code>$ cat colunas.txt
9 banana
8 maçã
7 abacate
6 uva
5 laranja
4 pêra
3 pokan
2 acerola
1 cajá
</code></pre><p>Entenda o comportamento de <code>sort -k1 colunas.txt</code> e <code>sort -k2 colunas.txt</code>.</p>
<h2 id="uniq">uniq</h2>
<p>O <code>uniq</code> pelo nome já da sinais do que faça, o que ele faz é informar ou omitir linhas repetidas, vamos considerar o seguinte arquivo:</p>
<pre tabindex="0"><code>$ cat uniq.txt
zzzz
bbbb
zzzz
ffff
jjjj
kkkk
aaaa
zzzz
oooo
eeee
bbbb
mmmm
cccc
</code></pre><p>Fazendo o teste mais óbvio com o <code>uniq</code>:</p>
<pre tabindex="0"><code>$ uniq uniq.txt
zzzz
bbbb
zzzz
ffff
jjjj
kkkk
aaaa
zzzz
oooo
eeee
bbbb
mmmm
cccc
</code></pre><p>O mesmo retorno! Vamos ler a documentação na <code>man pages</code>:</p>
<blockquote>
<p>Filter adjacent matching lines from INPUT (or standard input), writing to OUTPUT (or standard output).</p>
</blockquote>
<p>Então, para ser efetivo no uso do <code>uniq</code> precisamos de usar o sort antes, vejamos:</p>
<pre tabindex="0"><code>$ sort uniq.txt | uniq
aaaa
bbbb
cccc
eeee
ffff
jjjj
kkkk
mmmm
oooo
zzzz
</code></pre><p>Agora sim conseguimos ver o uso efetivo do <code>uniq</code>.</p>
<h3 id="vendo-apenas-os-dados-repetidos">Vendo apenas os dados repetidos</h3>
<pre tabindex="0"><code>$ sort uniq.txt | uniq -d
bbbb
zzzz
</code></pre><h3 id="vendo-apenas-os-únicos">Vendo apenas os únicos</h3>
<pre tabindex="0"><code>$ sort uniq.txt | uniq -u
aaaa
cccc
eeee
ffff
jjjj
kkkk
mmmm
oooo
</code></pre><h3 id="bônus-5">Bônus</h3>
<p>Contanto as ocorrências:</p>
<pre tabindex="0"><code>$ sort uniq.txt | uniq -c
      1 aaaa
      2 bbbb
      1 cccc
      1 eeee
      1 ffff
      1 jjjj
      1 kkkk
      1 mmmm
      1 oooo
      3 zzzz
</code></pre><h2 id="awk">awk</h2>
<p>Acho que melhor do que criar uma explicação do que é o <code>awk</code>, preferi pegar a descrição do <a href="https://pt.wikipedia.org/wiki/AWK">Wikipedia</a> que diz tudo:</p>
<blockquote>
<p>A linguagem de programação AWK foi criada em 1977 pelos cientistas Alfred Aho, Peter J. Weinberger e Brian Kernighan no laboratório Bell Labs. A palavra AWK é uma abreviatura das iniciais dos sobrenomes dos criadores da linguagem (Aho, Weinberger e Kernighan).</p>
<p>A linguagem é interpretada linha por linha e tem como principal objetivo deixar os scripts de Shell em sistemas POSIX mais poderosos e com muito mais recursos sem utilizar muitas linhas de comando, podendo resolver infinidades de problemas do dia-a-dia do desenvolvedor nesses sistemas operacionais.</p>
<p>Baseada na linguagem C, é utilizada frequentemente por desenvolvedores para processar textos e manipular arquivos. Tem como os paradigmas linguagem de script, procedural e orientada a eventos.</p>
<p>Esta linguagem é considerada por muitos um importante marco para história da programação, tendo tido bastante influência na criação de outras linguagens de programação, como Perl e Lua.</p>
</blockquote>
<p>Então, sabendo do tamanho do universo que é o <code>awk</code> é claro que esse artigo não vai cobrir ele e vamos ser pontuais no que precisamos para resolver o nosso desafio de analisar os logs.</p>
<p>Vamos considerar o seguinte arquivo:</p>
<pre tabindex="0"><code>$ cat awk1.txt
colunaA colunaB colunaC
1       a       !
2       b       @
3       c       #
4       d       $
5       e       %
6       f       &amp;
</code></pre><h3 id="retornando-a-entrada">Retornando a entrada</h3>
<pre tabindex="0"><code>$ awk '{print($0)}' awk1.txt
colunaA colunaB colunaC
1       a       !
2       b       @
3       c       #
4       d       $
5       e       %
6       f       &amp;
</code></pre><h3 id="retornando-os-dados-isolados-por-coluna">Retornando os dados isolados por coluna</h3>
<pre tabindex="0"><code>$ awk '{print($1)}' awk1.txt
colunaA
1
2
3
4
5
6
</code></pre><pre tabindex="0"><code>$ awk '{print($2)}' awk1.txt
colunaB
a
b
c
d
e
f
</code></pre><pre tabindex="0"><code>$ awk '{print($3)}' awk1.txt
colunaC
!
@
#
$
%
&amp;
</code></pre><h3 id="usando-o-split">Usando o <code>split</code></h3>
<pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); print(l[0]) }'
</code></pre><pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); print(l[1]) }'
0
</code></pre><pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); print(l[1]) }'
0
</code></pre><pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); print(l[10]) }'
9
</code></pre><pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); print(l[11]) }'

</code></pre><p>Fique atento, o <code>awk</code> não da erro ao acessar uma posição do <code>array</code> que não possui dados.</p>
<h3 id="bônus-6">Bônus</h3>
<pre tabindex="0"><code>$ echo &quot;0,1,2,3,4,5,6,7,8,9&quot; | awk '{ split($0,l,&quot;,&quot;); c = l[3]; print c; if (c &lt; 2) { print(&quot;a&quot;) } else if (c == 2) { print(&quot;b&quot;) } else print(&quot;c&quot;) }'
</code></pre><p>Qual é a resposta?</p>
<h1 id="gerador-aleatório-de-logs">Gerador aleatório de logs</h1>
<p>Para demonstrar o uso combinado das ferramentas era preciso gerar um data set de logs. Hoje, é bem comum boa parte das aplicações escrevem seus logs no formato de JSON e esse era o meu caso. Então, no nosso arquivo de log vai conter apenas um JSON, por exemplo:</p>
<pre tabindex="0"><code>{&quot;remote_ip_addr&quot;: &quot;82.58.153.167&quot;, &quot;access_token&quot;: &quot;secret_a7f49337ecff4c50a97c3d23e7386e23&quot;, &quot;x_tid&quot;: &quot;d8d3d5b0-bd8d-4386-b381-c760a70b9f49&quot;, &quot;user_agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;, &quot;method&quot;: &quot;GET&quot;, &quot;path&quot;: &quot;/users/1&quot;, &quot;timestamp&quot;: &quot;2020-04-30 03:58:21&quot;, &quot;status_code&quot;: 201}
{&quot;remote_ip_addr&quot;: &quot;188.235.234.165&quot;, &quot;access_token&quot;: &quot;secret_df60122168e048ba846b81fed1b09a1d&quot;, &quot;x_tid&quot;: &quot;d60291e2-e5a2-4222-a038-67f4adc88012&quot;, &quot;user_agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;, &quot;method&quot;: &quot;DELETE&quot;, &quot;path&quot;: &quot;/robots.txt&quot;, &quot;timestamp&quot;: &quot;2020-04-30 03:58:45&quot;, &quot;status_code&quot;: 200}
{&quot;remote_ip_addr&quot;: &quot;51.203.201.123&quot;, &quot;access_token&quot;: &quot;secret_b36d6af8a0d542f1ae5be86ac38688a0&quot;, &quot;x_tid&quot;: &quot;74016c10-be59-45ff-b13c-ffd8732919d8&quot;, &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot;, &quot;method&quot;: &quot;DELETE&quot;, &quot;path&quot;: &quot;/users/12&quot;, &quot;timestamp&quot;: &quot;2020-04-30 03:58:48&quot;, &quot;status_code&quot;: 400}
{&quot;remote_ip_addr&quot;: &quot;59.1.220.255&quot;, &quot;access_token&quot;: &quot;secret_2eb5ec132dac4fecaeb32ef12cfd7cd8&quot;, &quot;x_tid&quot;: &quot;64659fa4-f9d6-4e10-98d5-fb5178a2cd1c&quot;, &quot;user_agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;, &quot;method&quot;: &quot;PUT&quot;, &quot;path&quot;: &quot;/security.txt&quot;, &quot;timestamp&quot;: &quot;2020-04-30 03:58:57&quot;, &quot;status_code&quot;: 500}
{&quot;remote_ip_addr&quot;: &quot;199.18.137.169&quot;, &quot;access_token&quot;: &quot;secret_289c094aa4784d60987873f914b326a6&quot;, &quot;x_tid&quot;: &quot;af1d4979-de7e-4f9d-95f5-9de310d570b7&quot;, &quot;user_agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;, &quot;method&quot;: &quot;PUT&quot;, &quot;path&quot;: &quot;/health&quot;, &quot;timestamp&quot;: &quot;2020-04-30 03:59:33&quot;, &quot;status_code&quot;: 301}
{&quot;remote_ip_addr&quot;: &quot;24.109.83.239&quot;, &quot;access_token&quot;: &quot;secret_e34f7166be1f40c2be3754aafffe334b&quot;, &quot;x_tid&quot;: &quot;47cfaca0-0345-441a-bb03-670285f29854&quot;, &quot;user_agent&quot;: &quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;, &quot;method&quot;: &quot;POST&quot;, &quot;path&quot;: &quot;/robots.txt&quot;, &quot;timestamp&quot;: &quot;2020-04-30 04:00:01&quot;, &quot;status_code&quot;: 500}
{&quot;remote_ip_addr&quot;: &quot;62.112.131.39&quot;, &quot;access_token&quot;: &quot;secret_b3351fdeb0cb40279c6d1f48febf5838&quot;, &quot;x_tid&quot;: &quot;60b8714d-4cdc-4948-932c-19f594b8e8eb&quot;, &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot;, &quot;method&quot;: &quot;GET&quot;, &quot;path&quot;: &quot;/robots.txt&quot;, &quot;timestamp&quot;: &quot;2020-04-30 04:00:21&quot;, &quot;status_code&quot;: 301}
{&quot;remote_ip_addr&quot;: &quot;50.243.130.83&quot;, &quot;access_token&quot;: &quot;secret_f9c8f3495f324707b2a49878ce253844&quot;, &quot;x_tid&quot;: &quot;7ab5d9d4-2629-423c-b9b7-309fcab1958b&quot;, &quot;user_agent&quot;: &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;, &quot;method&quot;: &quot;POST&quot;, &quot;path&quot;: &quot;/&quot;, &quot;timestamp&quot;: &quot;2020-04-30 04:00:39&quot;, &quot;status_code&quot;: 500}
{&quot;remote_ip_addr&quot;: &quot;17.180.155.70&quot;, &quot;access_token&quot;: &quot;secret_bae6bfd17dbc4ec9b7c9d6b2974f9ef6&quot;, &quot;x_tid&quot;: &quot;4a3beff7-bc2c-4535-bba0-9b9906f846bc&quot;, &quot;user_agent&quot;: &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:53.0) Gecko/20100101 Firefox/53.0&quot;, &quot;method&quot;: &quot;GET&quot;, &quot;path&quot;: &quot;/users/35&quot;, &quot;timestamp&quot;: &quot;2020-04-30 04:00:54&quot;, &quot;status_code&quot;: 400}
</code></pre><p>Entrando nos detalhes dos campos do log do nosso serviço acima:</p>
<ul>
<li><code>remote_ip_addr</code>: uma string com endereço IP da origem da requisição;</li>
<li><code>access_token</code>: o token usado para acessar a API;</li>
<li><code>x_tid</code>: um ID para identificar a requisição;</li>
<li><code>user_agent</code>: ferramenta de onde partiu a requisição;</li>
<li><code>method</code>: método HTTP usado na requisição;</li>
<li><code>path</code>: caminho no meu serviço onde chegou a requisição</li>
<li><code>timestamp</code>: instante no tempo que a requisição chegou; e</li>
<li><code>status_code</code>: código HTTP de retorno dado pelo serviço.</li>
</ul>
<h2 id="código-do-gerador-de-log">Código do gerador de log</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-python" data-lang="python"><span class="kn">import</span> <span class="nn">random</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">struct</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">import</span> <span class="nn">uuid</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="kn">import</span> <span class="n">randrange</span>


<span class="k">def</span> <span class="nf">generate_ip</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="k">return</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntoa</span><span class="p">(</span><span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s1">&#39;&gt;I&#39;</span><span class="p">,</span> <span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mh">0xffffffff</span><span class="p">)))</span>

<span class="n">IP_DATASET_SIZE</span> <span class="o">=</span> <span class="mi">100</span>
<span class="n">IP_DATASET</span> <span class="o">=</span> <span class="p">[</span><span class="n">generate_ip</span><span class="p">()</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">IP_DATASET_SIZE</span><span class="p">)]</span>
<span class="n">LOG_SIZE</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">USER_AGENTS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:53.0) Gecko/20100101 Firefox/53.0&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)&#34;</span><span class="p">,</span>
    <span class="s2">&#34;curl/7.35.0&#34;</span><span class="p">,</span>
    <span class="s2">&#34;Wget/1.15 (linux-gnu)&#34;</span>
<span class="p">]</span>
<span class="n">STATUSES</span> <span class="o">=</span> <span class="p">[</span><span class="mi">200</span><span class="p">,</span> <span class="mi">201</span><span class="p">,</span> <span class="mi">301</span><span class="p">,</span> <span class="mi">400</span><span class="p">,</span> <span class="mi">401</span><span class="p">,</span> <span class="mi">500</span><span class="p">]</span>
<span class="n">PATHS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;/&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/health&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/security.txt&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/robots.txt&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/users&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/users/1&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/users/12&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/users/35&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/users/100&#34;</span><span class="p">,</span>
    <span class="s2">&#34;/admin/users&#34;</span>
<span class="p">]</span>
<span class="n">METHODS</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s2">&#34;GET&#34;</span><span class="p">,</span>
    <span class="s2">&#34;POST&#34;</span><span class="p">,</span>
    <span class="s2">&#34;PUT&#34;</span><span class="p">,</span>
    <span class="s2">&#34;DELETE&#34;</span>
<span class="p">]</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2020</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">LOG_SIZE</span><span class="p">):</span>
    <span class="n">random_ip_pos</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">IP_DATASET_SIZE</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">random_user_agent_pos</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">USER_AGENTS</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">random_status_pos</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">STATUSES</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">random_path_pos</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">PATHS</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">random_method_pos</span> <span class="o">=</span> <span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">METHODS</span><span class="p">),</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">payload</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s2">&#34;remote_ip_addr&#34;</span><span class="p">:</span> <span class="n">IP_DATASET</span><span class="p">[</span><span class="n">random_ip_pos</span><span class="p">],</span>
        <span class="s2">&#34;access_token&#34;</span><span class="p">:</span> <span class="s2">&#34;secret_&#34;</span> <span class="o">+</span> <span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()</span><span class="o">.</span><span class="n">hex</span><span class="p">,</span>
        <span class="s2">&#34;x_tid&#34;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">uuid</span><span class="o">.</span><span class="n">uuid4</span><span class="p">()),</span>
        <span class="s2">&#34;user_agent&#34;</span><span class="p">:</span> <span class="n">USER_AGENTS</span><span class="p">[</span><span class="n">random_user_agent_pos</span><span class="p">],</span>
        <span class="s2">&#34;method&#34;</span><span class="p">:</span> <span class="n">METHODS</span><span class="p">[</span><span class="n">random_method_pos</span><span class="p">],</span>
        <span class="s2">&#34;path&#34;</span><span class="p">:</span> <span class="n">PATHS</span><span class="p">[</span><span class="n">random_path_pos</span><span class="p">],</span>
        <span class="s2">&#34;timestamp&#34;</span><span class="p">:</span> <span class="n">dt</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&#34;%Y-%m-</span><span class="si">%d</span><span class="s2"> %H:%M:%S&#34;</span><span class="p">),</span>
        <span class="s2">&#34;status_code&#34;</span><span class="p">:</span> <span class="n">STATUSES</span><span class="p">[</span><span class="n">random_status_pos</span><span class="p">],</span>
    <span class="p">}</span>
    <span class="n">dt</span> <span class="o">+=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="n">randrange</span><span class="p">(</span><span class="n">randrange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">1</span><span class="p">)))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
</code></pre></div><h1 id="analisando-os-logs">Analisando os logs</h1>
<h2 id="contando-a-quantidade-de-status_code">Contando a quantidade de status_code</h2>
<pre tabindex="0"><code>$ python generate.py | jq .status_code | sort | uniq --count
  14257 200
  14179 201
  14411 301
  14360 400
  14069 401
  28724 500
</code></pre><h2 id="rank-do-user-agents">Rank do user-agents</h2>
<pre tabindex="0"><code>$ python generate.py | jq .user_agent | sort | uniq --count | sort -k1 -n -r
  20113 &quot;Wget/1.15 (linux-gnu)&quot;
  10030 &quot;Mozilla/4.0 (compatible; MSIE 6.0; Windows NT 5.1; SV1)&quot;
  10008 &quot;Mozilla/5.0 (compatible; Googlebot/2.1; +http://www.google.com/bot.html)&quot;
   9993 &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/51.0.2704.79 Safari/537.36 Edge/14.14393&quot;
   9992 &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/58.0.3029.110 Safari/537.36&quot;
   9988 &quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:53.0) Gecko/20100101 Firefox/53.0&quot;
   9988 &quot;curl/7.35.0&quot;
   9963 &quot;Mozilla/5.0 (Windows; U; MSIE 7.0; Windows NT 6.0; en-US)&quot;
   9925 &quot;Mozilla/5.0 (compatible; bingbot/2.0; +http://www.bing.com/bingbot.htm)&quot;
</code></pre><h2 id="descobrindo-se-teve-conflitos-de-x-tid">Descobrindo se teve conflitos de X-TID</h2>
<pre tabindex="0"><code>$ python generate.py | jq .x_tid | sort | uniq --count | awk '{ if ($1 &gt; 1) print($0) }'
$ echo $?
0
</code></pre><p>Como não teve retorno e a execução foi um sucesso, significa que não teve conflitos de X-TID.</p>
<h2 id="rank-das-classes-de-ip">Rank das classes de IP</h2>
<p>Primeiro, vamos entender a decomposição decimal do IP, 172.16.254.1, por exemplo.</p>
<pre tabindex="0"><code>172 = 10101100 (8 bits)
16  = 00010000 (8 bits)
254 = 11111110 (8 bits)
1   = 00000001 (8 bits)

total de 32 bitss (4 bytes)
</code></pre><p>Agora, quais são as classes de IP:</p>
<ul>
<li>Classe A: Primeiro bit é <em>0</em> (zero)
<ul>
<li>começa: 0.0.0.0</li>
<li>termina: 127.255.255.255</li>
</ul>
</li>
<li>Classe B: Primeiros dois bits são <em>10</em>
<ul>
<li>começa: 128.0.0.0</li>
<li>termina: 191.255.255.255</li>
</ul>
</li>
<li>Classe C: Primeiros três bits são <em>110</em>
<ul>
<li>começa: 192.0.0.0</li>
<li>termina: 223.255.255.255</li>
</ul>
</li>
<li>Classe D: Primeiros quatro bits são: <em>1110</em>
<ul>
<li>começa: 224.0.0.0</li>
<li>termina: 239.255.255.255</li>
</ul>
</li>
<li>Classe E: Primeiros quatro bits são <em>1111</em>
<ul>
<li>começa: 240.0.0.0</li>
<li>termina: 255.255.255.254</li>
</ul>
</li>
</ul>
<p>Detalhes sobre as classes de IP <a href="https://pt.wikipedia.org/wiki/Endere%C3%A7o_IP#Classes_de_endere.C3.A7os">aqui</a>.</p>
<pre tabindex="0"><code>$ python generate.py | jq '.remote_ip_addr|split(&quot;.&quot;)[0]|tonumber' | awk '{ if ($1 &lt;= 127) { print &quot;A&quot;; } else if ($1 &lt;= 191) { print &quot;B&quot;; } else if ($1 &lt;= 223) { print &quot;C&quot;; } else if ($1 &lt;= 239) { print &quot;D&quot;; }  else { print &quot;E&quot;; } }' | sort | uniq -c | sort -k2
  49540 A
  23552 B
  10068 C
   8991 D
   7849 E
</code></pre><h1 id="conclusão">Conclusão</h1>
<p>O terminal e suas ferramentas são extremamante poderosos mas é preciso conhecer e praticar para ter produtividade além de muito Google e Stack Overflow. Quais ferramentas que você usa e como?</p>

		</div>
		<footer class="post__footer">
			
<div class="post__tags tags clearfix">
	<svg class="tags__badge icon icon-tag" width="16" height="16" viewBox="0 0 32 32"><path d="M32 19c0 1-1 2-1 2L21 31s-1 1-2 1-2-1-2-1L2 16c-1-1-1.4-2-1.4-2S0 12.5 0 11V3C0 1.5.8.8.8.8S1.5 0 3 0h8c1.5 0 3 .6 3 .6S15 1 16 2l15 15s1 1 1 2zM7 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/></svg>
	<ul class="tags__list">
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/terminal/" rel="tag">terminal</a>
		</li>
		<li class="tags__item">
			<a class="tags__link btn" href="/tags/dicas/" rel="tag">dicas</a>
		</li>
	</ul>
</div>
		</footer>
	</article>
</main>

<div class="authorbox clearfix">
	<figure class="authorbox__avatar">
		<img alt="João Maia avatar" src="/img/avatar.jpg" class="avatar" height="90" width="90">
	</figure>
	<div class="authorbox__header">
		<span class="authorbox__name">About João Maia</span>
	</div>
	<div class="authorbox__description">
		Pessoa que resolve problemas com o uso de softwares
	</div>
</div>


<section class="comments">
	<div id="disqus_thread"></div>
<script type="application/javascript">
    var disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "blog-hugo" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</section>


			</div>
			
		</div>
		<footer class="footer">
	<div class="container footer__container flex">
		
		<div class="footer__copyright">
			&copy; 2022 João Maia.
			<span class="footer__copyright-credits">Generated with <a href="https://gohugo.io/" rel="nofollow noopener" target="_blank">Hugo</a> and <a href="https://github.com/Vimux/Mainroad/" rel="nofollow noopener" target="_blank">Mainroad</a> theme.</span>
		</div>
	</div>
</footer>
	</div>
<script async defer src="/js/menu.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.6/MathJax.js?config=TeX-AMS-MML_HTMLorMML" async></script>
</body>
</html>